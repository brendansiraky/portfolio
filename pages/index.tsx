import type { NextPage } from 'next'
import Head from 'next/head'

import ReactFullpage from '@fullpage/react-fullpage'

import { Projects } from '../components/landing/projects/Projects'
import { LandingContext } from '../model/context/LandingContext'
import { fetchLanding } from '../api/fetchLanding'
import { Layout } from '../components/shared'
import { Hero } from '../components/landing'
import { Landing } from '../types/Landing'
import { Me } from '../components/landing/me/Me'

const Landing: NextPage<Landing> = (landing) => {

    const SectionWrapper: React.FC<{ children: JSX.Element }> = ({ children }) => (
        <div className="section">
            {children}
        </div>
    )

    console.log(landing.projects[0].technologies[0])

    return (
        <LandingContext.Provider value={landing}>
            <Layout>
                <Head>
                    <title>Brendan Hemat-Siraky</title>
                    <meta name="description" content="Generated by create next app" />
                    <link rel="icon" href="/favicon.ico" />
                </Head>

                <ReactFullpage
                    licenseKey={process.env.FULLPAGE_LICENSE_KEY || ''}
                    showActiveTooltip={false}
                    navigation={true}
                    render={() => {
                        return (
                            <ReactFullpage.Wrapper>
                                <SectionWrapper>
                                    <Hero />
                                </SectionWrapper>
                                <SectionWrapper>
                                    <Me />
                                </SectionWrapper>
                                <SectionWrapper>
                                    <Projects projects={landing.projects} />
                                </SectionWrapper>
                            </ReactFullpage.Wrapper>
                        )
                    }}
                />
            </Layout>
        </LandingContext.Provider>
    )
}

export async function getStaticProps() {
    const landing = await fetchLanding()

    return {
        props: {
            ...landing
        },
    }
}

export default Landing